/*
 * JS for startScreen generated by Appery.io
 */
Apperyio.getProjectGUID = function() {
    return 'ec7518f9-d042-4137-bf4f-6bad235470fc';
};

function navigateTo(outcome, useAjax) {
    Apperyio.navigateTo(outcome, useAjax);
}

function adjustContentHeight() {
    Apperyio.adjustContentHeightWithPadding();
}

function adjustContentHeightWithPadding(_page) {
    Apperyio.adjustContentHeightWithPadding(_page);
}

function setDetailContent(pageUrl) {
    Apperyio.setDetailContent(pageUrl);
}
Apperyio.AppPages = [{
    "name": "medical",
    "location": "medical.html"
}, {
    "name": "products",
    "location": "products.html"
}, {
    "name": "startScreen",
    "location": "startScreen.html"
}, {
    "name": "datacom",
    "location": "datacom.html"
}, {
    "name": "automotive",
    "location": "automotive.html"
}];




function getAllUrlParams(url) {

  // get query string from url (optional) or window
  var queryString = url ? url.split('?')[1] : window.location.search.slice(1);

  // we'll store the parameters here
  var obj = {};

  // if query string exists
  if (queryString) {

    // stuff after # is not part of query string, so get rid of it
    queryString = queryString.split('#')[0];

    // split our query string into its component parts
    var arr = queryString.split('&');

    for (var i=0; i<arr.length; i++) {
      // separate the keys and the values
      var a = arr[i].split('=');

      // in case params look like: list[]=thing1&list[]=thing2
      var paramNum = undefined;
      var paramName = a[0].replace(/\[\d*\]/, function(v) {
        paramNum = v.slice(1,-1);
        return '';
      });

      // set parameter value (use 'true' if empty)
      var paramValue = typeof(a[1])==='undefined' ? true : a[1];

      // (optional) keep case consistent
      

      // if parameter name already exists
      if (obj[paramName]) {
        // convert value to array (if still string)
        if (typeof obj[paramName] === 'string') {
          obj[paramName] = [obj[paramName]];
        }
        // if no array index number specified...
        if (typeof paramNum === 'undefined') {
          // put the value on the end of the array
          obj[paramName].push(paramValue);
        }
        // if array index number specified...
        else {
          // put the value at that index number
          obj[paramName][paramNum] = paramValue;
        }
      }
      // if param name doesn't exist yet, set it
      else {
        obj[paramName] = paramValue;
      }
    }
  }

  return obj;
}

function replaceAll(str, find, replace) {
    return str.replace(new RegExp(find, 'g'), replace);
}

function ajax(){
    
    var search = getAllUrlParams().search;
     var c=0;
     var collumn=0;
  
    try {
    $.ajax({
        url: 'http://web-dev.us/Interplex-backend/search.php',
        type: "GET",
        dataType: 'jsonp',
        jsonp: 'callback',
        timeout: 5000,
        data:{
        search: search
        },
        success: function(data, status){
           
             var count = data.length;
              var total = Math.round(count/3);
              
              
            $.each(data, function(i,item){ 
            
               
             
             
                 if(c==total){
                       
                        c=1;collumn++;
                        
                  }  
                    
                  
                if (collumn==0){
                    
                    
                    
                    $(".tabs_sub_left").append("<div class='category_name_product'><a href=products.html?product="+item.Mark+"><img width='100%' src=http://web-dev.us/Interplex-backend/"+item.Mark+"/"+item.Mark+".jpg /></a><div class='name_cat'>"+item.Name+"</div></div>");
                  
                   
                } 
                
                
                 if (collumn==1){
                     
                     
                      
                    $(".tabs_sub_center").append("<div class='category_name_product'><a href=products.html?product="+item.Mark+"><img width='100%' src=http://web-dev.us/Interplex-backend/"+item.Mark+"/"+item.Mark+".jpg /></a><div class='name_cat'>"+item.Name+"</div></div>");
                    
                    
                } 
                
                
                 if (collumn==2){
                    $(".tabs_sub_right").append("<div class='category_name_product'><a href=products.html?product="+item.Mark+"><img width='100%' src=http://web-dev.us/Interplex-backend/"+item.Mark+"/"+item.Mark+".jpg /></a><div class='name_cat'>"+item.Name+"</div></div>");
                    
                   
                } 
                  
               c++;  
             
              
            });
        },
        error: function(data){
            console.log(data);
           $(".name").append('There was an error loading the data.');
        }
    });

}
catch (e) {

   logMyErrors(e); 
}
    
}

function startScreen_js() {
    /* Object & array with components "name-to-id" mapping */
    var n2id_buf = {
    };
    if ("n2id" in window && window.n2id !== undefined) {
        $.extend(n2id, n2id_buf);
    } else {
        window.n2id = n2id_buf;
    }
    /*
     * Nonvisual components
     */
    Apperyio.mappings = Apperyio.mappings || {};
    Apperyio.mappings["startScreen_restservice1_onbeforesend_mapping_0"] = {
        "homeScreen": "startScreen",
        "directions": [
            {
                "to_name": "restservice1",
                "to_type": "SERVICE_REQUEST",
                "to_default": {
                    "headers": {
                        "X-Appery-Database-Id": "{database_id}"
                    },
                    "parameters": {},
                    "body": null
                },
                "mappings": []
            }
        ]
    };
    Apperyio.datasources = Apperyio.datasources || {};
    window.restservice1 = Apperyio.datasources.restservice1 = new Apperyio.DataSource(Automotive_Products_list_service, {
        "onBeforeSend": function(jqXHR) {
            Apperyio.processMappingAction(Apperyio.mappings["startScreen_restservice1_onbeforesend_mapping_0"]);
        },
        "onComplete": function(jqXHR, textStatus) {
        },
        "onSuccess": function(data) {},
        "onError": function(jqXHR, textStatus, errorThrown) {}
    });
    Apperyio.CurrentScreen = 'search';
    _.chain(Apperyio.mappings)
        .filter(function(m) {
            return m.homeScreen === Apperyio.CurrentScreen;
        })
        .each(Apperyio.UIHandler.hideTemplateComponents);
    /*
     * Events and handlers
     */
    // On Load
    var startScreen_onLoad = function() {
        startScreen_elementsExtraJS();
        startScreen_deviceEvents();
        startScreen_windowEvents();
        startScreen_elementsEvents();
    };
    // screen window events
    function startScreen_windowEvents() {
        $('#search').bind('pageshow orientationchange', function() {
            var _page = this;
            adjustContentHeightWithPadding(_page);
        });
      
          $('#search').on({
            pageshow: function(event) {
                try {
                    ajax();
                } catch (e) {
                    console.error(e);
                    hideSpinner();
                };
            },
        });  
        
    };
    // device events
    function startScreen_deviceEvents() {
        document.addEventListener("deviceready", function() {
        });
    };
    // screen elements extra js
    function startScreen_elementsExtraJS() {
        // screen (startScreen) extra code
    };
    // screen elements handler
    function startScreen_elementsEvents() {
        $(document).on("click", "a :input,a a,a fieldset label", function(event) {
            event.stopPropagation();
        });
    };
    $(document).off("pagebeforeshow", "#search").on("pagebeforeshow", "#search", function(event, ui) {
        Apperyio.CurrentScreen = "search";
        _.chain(Apperyio.mappings)
            .filter(function(m) {
                return m.homeScreen === Apperyio.CurrentScreen;
            })
            .each(Apperyio.UIHandler.hideTemplateComponents);
    });
    startScreen_onLoad();
};
$(document).off("pagecreate", "#search").on("pagecreate", "#search", function(event, ui) {
    Apperyio.processSelectMenu($(this));
    $(".counter").html(pocet);
    startScreen_js();
});